<div class="container my-4">
  <div class="row g-3 mb-4">
    <div class="col-md-3"><div class="card"><div class="card-body"><div class="text-muted">Products</div><div class="fs-4 fw-bold"><%= total_products %></div></div></div></div>
    <div class="col-md-3"><div class="card"><div class="card-body"><div class="text-muted">Revenue</div><div class="fs-4 fw-bold">$<%= number_with_precision(total_revenue, precision: 2) %></div></div></div></div>
  </div>

  <h5 class="mt-3">Top products (by revenue)</h5>
  <div class="card mb-4">
    <div class="card-body p-0">
      <table class="table table-hover mb-0">
        <thead><tr><th>Product</th><th class="text-end">Revenue</th></tr></thead>
        <tbody>
          <% top_products.each do |(product_id), rev| %>
            <% product = products.find { |p| p.id == product_id } %>
            <tr>
              <td><%= product ? link_to(product.name, product_path(product)) : "Product ##{product_id}" %></td>
              <td class="text-end">$<%= number_with_precision(rev, precision: 2) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <h5>Recent sales</h5>
  <div class="card">
    <div class="card-body p-0">
      <table class="table table-hover mb-0">
        <thead><tr><th>Date</th><th>Product</th><th class="text-end">Amount</th></tr></thead>
        <tbody>
          <% recent_items.each do |item| %>
            <tr>
              <td><%= l(item.order.created_at, format: :short) %></td>
              <td><%= link_to item.product.name, product_path(item.product) %></td>
              <td class="text-end">
                $<%= number_with_precision((item.quantity || 1) * item.price_at_purchase, precision: 2) %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>